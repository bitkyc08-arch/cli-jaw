# Phase 5.8: CLI Status 갱신 주기

## 현재 동작

- `loadCliStatus()` → `GET /api/cli-status` + `GET /api/quota` (Promise.all)
- Settings 탭 클릭할 때마다 호출 (L822)
- 서버: `detectAllCli()` = 4개 CLI `which`  검사 + `readClaudeAccount()`, `readCodexAccount()` 등
- **문제**: 매번 느려서 탭 전환마다 "Loading..." 보임

## 수정 계획

### 1. 설정 로드 순서 재배치

Settings 탭 진입 시:
1. 설정값 먼저 표시 (이미 메모리에 있음)
2. CLI status는 **마지막에** 비동기 로드

### 2. 갱신 주기 설정 추가 (`settings.json`)

```json
{
  "cliStatusInterval": 300  // 초 단위, 기본 5분
}
```

### 3. 캐시 + 타이머

```js
let cliStatusCache = null;
let cliStatusTs = 0;

async function loadCliStatus(force = false) {
    const interval = settings.cliStatusInterval || 300;
    if (!force && cliStatusCache && (Date.now() - cliStatusTs) < interval * 1000) {
        renderCliStatus(cliStatusCache);  // 캐시 사용
        return;
    }
    // 실제 fetch...
    cliStatusCache = { cliStatus, quota };
    cliStatusTs = Date.now();
}
```

### 4. UI: Settings 탭 하단에 갱신 주기 설정

Settings 탭 맨 아래에:
```html
<label>CLI 상태 갱신 주기</label>
<select>
  <option value="60">1분</option>
  <option value="300" selected>5분</option>  
  <option value="600">10분</option>
  <option value="0">수동만</option>
</select>
```

## 체크리스트

- [ ] `loadCliStatus` 캐시 + interval 체크
- [ ] `settings.json`에 `cliStatusInterval` 추가
- [ ] Settings UI 하단에 갱신 주기 select
- [ ] 탭 전환 시 캐시 우선, 만료 시 자동 갱신
