# 6.5 Web UI 응답 중복 표시

## 증상

텔레그램에서 메시지 보내면:
- Input: Web UI에 **1번** 표시 ✅
- Output: Web UI에 **2번** 표시 ❌

## 원인

assistant 응답이 두 경로로 Web UI에 전달:
1. `spawnAgent` → `broadcast('agent_done')` → `finalizeAgent()` (기존 경로)
2. telegram 핸들러 → `broadcast('new_message')` → `addMessage()` (6.2에서 추가)

DB 저장도 중복: `spawnAgent`의 `insertMessage` + telegram 핸들러의 `insertMessage`

## 수정

telegram 핸들러에서 **assistant** `insertMessage` + `broadcast('new_message')` 제거.

- user 메시지: telegram 핸들러가 저장 + broadcast (spawnAgent는 user 메시지 안 저장)
- assistant 메시지: spawnAgent가 저장 + agent_done broadcast (telegram은 건드리지 않음)
