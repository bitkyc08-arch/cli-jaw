# Phase 5.10: Tool/Reasoning ì´ë²¤íŠ¸ ì‹¤ì‹œê°„ í‘œì‹œ + ì ‘ê¸°

## ì ‘ê·¼ë²•

ì´ë²¤íŠ¸ íƒ€ì…ë³„ í•˜ë“œì½”ë”© âŒ â†’ **ë²”ìš© íŒŒì‹±** âœ…

ëª¨ë“  raw ì´ë²¤íŠ¸ì—ì„œ ì˜ë¯¸ìˆëŠ” í•„ë“œë¥¼ ì¶”ì¶œí•˜ì—¬:
1. **ì‹¤ì‹œê°„**: í•œ ì¤„ì”© ì‹œìŠ¤í…œ ë©”ì‹œì§€ë¡œ í‘œì‹œ
2. **ì™„ë£Œ ì‹œ**: í™œë™ ë¡œê·¸ë¥¼ ì ‘ê¸°(collapsible)ë¡œ ë‹µë³€ ìœ„ì— í‘œì‹œ

## ì„œë²„

### extractFromEventì—ì„œ broadcast

`agent_message`/`text`/`result` ì™¸ì˜ ëª¨ë“  ì´ë²¤íŠ¸ â†’ label ì¶”ì¶œ â†’ broadcast:

```js
function extractToolLabel(cli, event) {
    // ë²”ìš©: ì´ë²¤íŠ¸ì—ì„œ ì˜ë¯¸ìˆëŠ” í•œ ì¤„ ì¶”ì¶œ
    const item = event.item || event.part || event;
    const type = item.type || event.type;
    
    // ê²€ìƒ‰
    if (type === 'web_search' || type === 'tool_use' || type === 'tool-call') {
        const name = item.tool_name || item.tool || item.name || type;
        const query = item.query || item.parameters?.command || '';
        return { icon: 'ğŸ”§', label: `${name}${query ? ': ' + query.slice(0,60) : ''}` };
    }
    // ì¶”ë¡ 
    if (type === 'reasoning' || type === 'thinking') {
        const text = item.text || item.thinking || '';
        return { icon: 'ğŸ’­', label: text.slice(0,60) };
    }
    // ëª…ë ¹ ì‹¤í–‰
    if (type === 'command_execution') {
        return { icon: 'âš¡', label: item.command || 'exec' };
    }
    // ê²°ê³¼
    if (type === 'tool_result') {
        return { icon: 'âœ…', label: `${item.status || 'done'}` };
    }
    return null;  // íŒŒì‹± ë¶ˆê°€ â†’ ë¬´ì‹œ
}
```

### broadcast í˜¸ì¶œ

```js
const toolLabel = extractToolLabel(cli, event);
if (toolLabel) {
    broadcast('agent_tool', { agentId, ...toolLabel });
    ctx.toolLog.push(toolLabel);  // ì ‘ê¸°ìš© ëˆ„ì 
}
```

## í”„ë¡ íŠ¸

### ì‹¤ì‹œê°„ í‘œì‹œ

```js
case 'agent_tool':
    addSystemMsg(`${msg.icon} ${msg.label}`);
    break;
```

### ì™„ë£Œ ì‹œ ì ‘ê¸° (ë‹µë³€ ìœ„)

`agent_done` ì´ë²¤íŠ¸ì—ì„œ toolLog í¬í•¨:

```html
<details class="tool-summary">
  <summary>ğŸ”§ 3ê°œ ë„êµ¬ ì‚¬ìš© Â· ğŸ’­ 2ê°œ ì¶”ë¡ </summary>
  <div class="tool-log">
    ğŸ’­ Summarizing detailed hockey recap
    ğŸ”§ web_search: 2026 Olympics hockey
    ğŸŒ open_page: iihf.com
    âš¡ exec: echo "Hello"
    âœ… success
  </div>
</details>
```

## ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì„œë²„: `extractToolLabel()` ë²”ìš© í•¨ìˆ˜
- [ ] ì„œë²„: extractFromEventì—ì„œ broadcast í˜¸ì¶œ + toolLog ëˆ„ì 
- [ ] ì„œë²„: agent_doneì— toolLog í¬í•¨
- [ ] í”„ë¡ íŠ¸: agent_tool â†’ addSystemMsg ì‹¤ì‹œê°„ í‘œì‹œ
- [ ] í”„ë¡ íŠ¸: agent_done â†’ details/summary ì ‘ê¸° í‘œì‹œ
